<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="git-leaf - simple git history viewer">
    <meta name="author" content="Daniel Bugl">
    <link rel="shortcut icon" href="favicon.png">

    <title>Donate me coffee!</title>

    <!-- Bootstrap core CSS -->
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="main.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>

<body>

<div class="mainframe">
    <div class="jumbotron">
        <div class="container">
            <div class="row-container">
                <div class="row">
                    <div class="col-md-2">
                        <i id="main-coffee" class="fa fa-coffee fa-5x"></i>
                        <button type="button" class="btn btn-default" id="add-cup">
                            <i class="fa fa-plus"></i> <i class="fa fa-coffee"></i>
                        </button>
                        <!-- TODO: Improve design of +coffee button -->
                    </div>
                    <div id="moar-coffee" style="display: none;">

                    </div>
                    <div id="much-moar-coffee" style="display: none;">
                        <span id="coffee-cups"></span> x <i class="fa fa-coffee"></i> <!-- TODO: allow people to enter amount manually -->
                        <!-- TODO: update total price -->
                    </div>
                    <div id="main-box" class="col-md-10">
                        <h1>Buy me coffee!</h1>
                        <span id="price-eur"></span> <i class='fa fa-euro'></i> |
                        <span id="price-usd"></span> <i class='fa fa-dollar'></i> |
                        <span id="price-btc"></span> <i class='fa fa-btc'></i>
                        <!-- TODO: improve the style of this -->
                        <!-- TODO: add donate buttons -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript placed at the end of the document so the pages load faster -->
<script src="js/jquery-2.0.3.min.js"></script>
<script src="js/bitcoinprices.js"></script>

<script>
    var coffee = 1;

    function addCoffee() {
        if (coffee == 1) {
            $("#moar-coffee").addClass('col-md-2');
            $("#main-box").removeClass('col-md-10');
            $("#main-box").addClass('col-md-8');

            $("#moar-coffee").show();
        }

        if (coffee <= 10) {
            $("#moar-coffee").append('<i class="fa fa-coffee"></i> ');
        } else {
            $("#moar-coffee").empty();
            $("#moar-coffee").removeClass('col-md-2');
            $("#moar-coffee").hide();

            $("#much-moar-coffee").show();
            $("#much-moar-coffee").addClass('col-md-2');
            $("#coffee-cups").html(coffee);
        }

        coffee += 1;
        updatePrices();
    }

    function updatePrices() {
        $('#price-eur').html((2.00 * coffee).toFixed(2));
        $('#price-usd').html(bitcoinprices.convert(2.00 * coffee, 'EUR', 'USD').toFixed(2));
        $('#price-btc').html(bitcoinprices.convert(2.00 * coffee, 'EUR', 'BTC').toFixed(5));
    }

    $(document).ready(function() {
        bitcoinprices.init({

            // Where we get bitcoinaverage data
            url: "https://api.bitcoinaverage.com/ticker/all",

            // Which of bitcoinaverages value we use to present prices
            marketRateVariable: "24h_avg",

            // Which currencies are in shown to the user
            currencies: ["BTC", "USD", "EUR"],

            // Special currency symbol artwork
            symbols: {
                "BTC": "<i class='fa fa-btc'></i>"
            },

            // Which currency we show user by the default if
            // no currency is selected
            defaultCurrency: "BTC",

            // How the user is able to interact with the prices
            ux : {
                // Make everything with data-btc-price HTML attribute clickable
                clickPrices : false,

                // Build Bootstrap dropdown menu for currency switching
                menu : false
            }
        });

        $(document).bind('marketdataavailable', function () {
            updatePrices();
        });

        $('#main-coffee').click(function () {
            addCoffee();
        });

        $('#add-cup').click(function () {
            addCoffee();
        });
    });
</script>

</body>
</html>
